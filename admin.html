<!doctype html>
<html lang="pl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>panel — dodaj wiersz</title>
    <meta name="robots" content="noindex, nofollow" />
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif; margin: 24px; }
        label { display:block; margin: 12px 0 6px; font-weight: 600; }
        input[type=text], textarea { width: 100%; max-width: 820px; padding: 10px; font: inherit; }
        textarea { height: 320px; }
        button { margin-top: 16px; padding: 10px 14px; font: inherit; cursor: pointer; }
        .hint { color: #666; font-size: 12px; margin-top: 4px; }
        .ok { color: #0a7d2e; }
        .err { color: #b00020; }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
    </style>
    <script>
    async function submitPoem(e) {
        e.preventDefault();
        const poemTitle = document.getElementById('poemTitle').value;
        const poemText = document.getElementById('poemText').value;
        const token = localStorage.getItem('adminToken') || '';
        const resp = await fetch('/api/add-poem', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({ poemTitle, poemText })
        });
        const out = document.getElementById('out');
        if (resp.ok) {
            const data = await resp.json();
            out.innerHTML = `<span class="ok">OK:</span> ${data.message || 'dodano'}`;
        } else {
            const err = await resp.json().catch(() => ({}));
            out.innerHTML = `<span class="err">Błąd:</span> ${err.error || resp.status}`;
        }
    }
    function saveToken() {
        const t = document.getElementById('token').value.trim();
        localStorage.setItem('adminToken', t);
        document.getElementById('tokInfo').textContent = t ? 'zapisano' : 'usunięto';
    }
    </script>
    </head>
<body>
    <h1>Dodaj wiersz</h1>
    <p class="mono">Bearer token: <input type="password" id="token" placeholder="wklej ADMIN_TOKEN" oninput="saveToken()" /> <span id="tokInfo" class="hint"></span></p>
    <form onsubmit="submitPoem(event)">
        <label for="poemTitle">Tytuł (opcjonalnie)</label>
        <input type="text" id="poemTitle" name="poemTitle" placeholder="np. po pełni" />
        <div class="hint">Tytuł zapisywany jest jako komentarz w poems.html.</div>

        <label for="poemText">Treść wiersza</label>
        <textarea id="poemText" name="poemText" placeholder="Wpisz wiersz. Nowe linie zostaną zapisane jako &lt;br&gt;."></textarea>
        <div class="hint">Zachowaj puste linie tam, gdzie chcesz przerwę akapitową.</div>

        <button type="submit">Dodaj</button>
    </form>
    <p id="out" class="mono"></p>
    <p class="hint">Po dodaniu odśwież <a href="/poems.html" target="_blank" rel="noopener">poems.html</a> i <a href="/index.html" target="_blank" rel="noopener">index.html</a>.</p>
</body>
</html>


